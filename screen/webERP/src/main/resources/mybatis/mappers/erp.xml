<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mappers.erp">
	<resultMap id="SmBimResult"
		type="CommitOperationInstructionVO">
		<result property="itemCode" column="Item_Code" />
		<result property="itemName" column="Item_Name" />
		<result property="standard" column="Standard" />
		<result property="inventoryUnit" column="Inventory_Unit" />
		<result property="dailyProduction" column="DailyProduction" />
	</resultMap>
	<resultMap id="OpePerRegResult" type="OperationRegistVO">
		<result property="workOrderNumber" column="workOrderNumber" />
		<result property="instructionDate" column="InstructionDate" />
		<result property="dueDate" column="dueDate" />
		<result property="itemCode" column="Item_Code" />
		<result property="itemName" column="Item_Name" />
		<result property="standard" column="Standard" />
		<result property="inventoryUnit" column="Inventory_Unit" />
		<result property="indicated" column="IndicatedQuantity" />
		<result property="status" column="status" />
		<result property="inspection" column="Inspection" />
		<result property="note" column="note" />
	</resultMap>
	<resultMap id="FactoryViewResult" type="FactoryViewVO">
		<result property="workplaceCode" column="workplace_Code" />
		<result property="workplaceName" column="workplace_Name" />
	</resultMap>
	<select id="selectAllProductionPlanInfo" resultMap="SmBimResult">
		<![CDATA[select Item_Code, Item_Name, Standard, Inventory_Unit, DailyProduction from SM_BIM_Ite_Reg]]>
	</select>
	<select id="selectAllOperationRegistInfo" resultMap="OpePerRegResult">
		<![CDATA[select * from CPM_PM_Ope_Per_Reg]]>
	</select>
	
	<select id="selectFactoryList" resultMap="FactoryViewResult">
		<![CDATA[select * from SM_CRI_Wor_Reg]]>
	</select>
	 
	<!-- BOM 파트 -->
	<resultMap id="bomView" type="bomVO">
		<result property="no" column="no" />
		<result property="itemNumber" column="item_code" />
		<result property="itemName" column="item_name" />
		<result property="standard" column="standard" />
		<result property="unit" column="invenvtory_unit" />
		<result property="precisionQuantity" column="precisionQuantity" />
		<result property="loss" column="loss" />
		<result property="actualCost" column="actualCost" />
		<result property="outSourcingUnitPrice"
			column="outSourcingUnitPrice" />
		<result property="startDate" column="startDate" />
		<result property="endDate" column="endDate" />
		<result property="note" column="note" />
	</resultMap>
	<resultMap id="popView" type="bomVO">
		<result property="itemNumber" column="item_code" />
		<result property="itemName" column="item_name" />
		<result property="standard" column="standard" />
	</resultMap>

	<select id="selectAllMemberList" resultMap="bomView">
		<![CDATA[select * from CPM_BIM_BOM_REG]]>
	</select>
	<select id="searchitem" resultMap="bomView"
		parameterType="String">
		<![CDATA[select * from CPM_BIM_BOM_REG where item_code = #{itemNumber}]]>
	</select>
	<select id="selectitem" resultMap="bomView"
		parameterType="String">
		<![CDATA[select item_code,item_name,standard,inventory_unit from CPM_BIM_BOM_REG where item_code=#{itemNumber}]]>
	</select>
	<select id="selectPopList" resultMap="popView">
		<![CDATA[select * from CPM_BIM_BOM_REG]]>
	</select>
	<insert id="insertBOM" parameterType="bomVO">
		<![CDATA[
		 insert into CPM_BIM_BOM_REG
		 values(#{no}, #{itemNumber}, #{itemName}, #{standard}, #{unit}, #{precisionQuantity}, #{loss}, #{actualQuantity}, #{actualCost}, #{outSourcingUnitPrice}, #{startDate}, #{endDate}, #{note})
		]]>  
	</insert>
	<update id="updateBOM" parameterType="bomVO">
		<![CDATA[
		update CPM_BIM_BOM_REG
		set item_name=#{itemName}, standard=#{standard}, inventory_unit=#{unit}
		where  item_code=#{itemNumber}
		]]>  
	</update>
	

	<!-- mainPaln 파트 -->
	<resultMap id="mainplanResult" type="mainplanVO">
		<result property="plandate" column="plandate" />
		<result property="itemnumber" column="itemnumber" />
		<result property="itemName" column="itemName" />
		<result property="standard" column="standard" />
		<result property="unit" column="unit" />
		<result property="sequence" column="sequence" />
		<result property="expected_date" column="expected_date" />
		<result property="due_date" column="due_date" />
		<result property="plan_quantity" column="plan_quantity" />
		<result property="buyer" column="buyer" />
		<result property="note" column="note" />
	</resultMap>
	<resultMap type="mpsosVO" id="MpsOSResult">
		<result column="ordersno" property="ordersno" />
		<result column="sequence" property="sequence" />
		<result column="orderdate" property="orderdate" />
		<result column="okeydate" property="okeydate" />
		<result column="buyer" property="buyer" />
		<result column="itemnumber" property="itemnumber" />
		<result column="itemName" property="itemName" />
		<result column="standard" property="standard" />
		<result column="unit" property="unit" />
		<result column="order_quantity" property="order_quantity" />
		<result column="apply_quantity" property="apply_quantity" />
		<result column="order_Balance" property="order_Balance" />
		<result column="expected_Date" property="expected_Date" />
		<result column="note" property="note" />
	</resultMap>

	<select id="selectAllMainPlanList" resultMap="mainplanResult">
		<![CDATA[SELECT * from pmm_pm_mps]]>
	</select>
	<select id="selectAllMpsosList" resultMap="MpsOSResult">
		<![CDATA[SELECT * from pmm_pm_mps_os]]>
	</select>

	<!-- billing파트 -->
	<resultMap id="billingResult" type="billingVO">
		<result property="claim_no" column="claim_no" />
		<result property="claim_date" column="claim_date" />
		<result property="claim_division" column="claim_division" />
		<result property="note" column="note" />
	</resultMap>
	<resultMap id="ListResult" type="listVO">
		<result column="sequence" property="sequence" />
		<result column="itemNumber" property="itemNumber" />
		<result column="itemName" property="itemName" />
		<result column="standard" property="standard" />
		<result column="requestdate" property="requestdate" />
		<result column="inventory_unit" property="inventory_unit" />
		<result column="inventory_qy" property="inventory_qy" />
		<result column="claim_unit" property="claim_unit" />
		<result column="claim_quantity" property="claim_quantity" />
		<result column="buyer" property="buyer" />		
	</resultMap>
	<resultMap id="mrpamountResult" type="requiredamountVO">
		<result property="need_date" column="need_date" />
		<result property="expected_order" column="expected_order" />
		<result property="itemnumber" column="itemnumber" />
		<result property="itemname" column="itemname" />
		<result property="standard" column="standard" />
		<result property="unit" column="unit" />
		<result property="expected_quantity" column="expected_quantity" />
	</resultMap>

	<select id="selectAllcmList" resultMap="billingResult">
		<![CDATA[SELECT * from PMM_PM_CM]]>
	</select>
	
	<select id="selectAllBottomList" resultMap="ListResult">
		<![CDATA[select * from pmm_pm_cm_list]]>
	</select>
	
	<select id="selectAllMrpaMount" resultMap="mrpamountResult">
		<![CDATA[select need_date,expected_order,itemnumber,itemname,standard,unit,expected_quantity
			from pmm_pm_mrp]]>
	</select>

	<!-- mrp파트 -->
	<resultMap id="mrpResult" type="requiredamountVO">
		<result property="itemnumber" column="itemnumber" />
		<result property="itemname" column="itemname" />
		<result property="standard" column="standard" />
		<result property="need_date" column="need_date" />
		<result property="sequence" column="sequence" />
		<result property="expected_order" column="expected_order" />
		<result property="expected_quantity" column="expected_quantity" />
		<result property="unit" column="unit" />
	</resultMap>

	<select id="selectAllMrpList" resultMap="mrpResult">
		<![CDATA[SELECT * from pmm_pm_mrp]]>
	</select>
	
	
		<!--popitem-->
	<resultMap id="itemResult" type="itemviewVO">
		<result property="item_code" column="item_code" />
        <result property="item_name" column="item_name" />        
        <result property="standard" column="standard" />
        <result property="inventory_unit" column="inventory_unit" />
	</resultMap> 
	<resultMap id="salesplan" type="itemviewVO">
		<result property="plancode" column="plan_code" />
		<result property="item_code" column="item_code" />
        <result property="item_name" column="item_name" />
        <result property="standard" column="standard" />
        <result property="inventory_unit" column="inventory_unit" />
        <result property="planquantity" column="plan_item_quantity" />
        <result property="planprice" column="plan_unit_price" />
        <result property="newquantity" column="newplan_item_quantity" />
        <result property="newprice" column="newplan_unit_price" />
        <result property="plandate" column="plan_date" />
	</resultMap> 

	<select id="selectAllItemList" resultMap="itemResult">
      <![CDATA[
         select * from SM_BIM_Ite_Reg 
      ]]>
	</select>
	
	<select id="selectAllSalesplanList" resultMap="salesplan">
      <![CDATA[
         select * from SM_BIM_Sal_Pla_Reg 
      ]]>
	</select>
	
     <select id="submititemview" resultMap="salesplan" parameterType="String">
		<![CDATA[
		 select * from SM_BIM_Sal_Pla_Reg where item_code = #{item_code}
		]]>   
	</select> 
	
	  <select id="selPlancode" resultMap="salesplan" parameterType="int">
		<![CDATA[
		SELECT LAST_NUMBER FROM USER_SEQUENCES
		 WHERE SEQUENCE_NAME = upper('seq_SM_BIM_Gen_Cus_Reg_no')
		]]>
	</select> 
	
	<insert id="insertSalesplan" parameterType="itemviewVO">
		<![CDATA[
		 insert into SM_BIM_Sal_Pla_Reg
		 values(F_GET_NEXT_SEQ('SM_BIM_Sal_Pla_Reg'), #{item_code}, #{item_name}, #{standard}, #{inventory_unit},
		  #{planquantity}, #{planprice}, #{actualQuantity}, '0', '0',sysdate)
		]]>  
	</insert>
	
	<delete id="deletePlan"  parameterType="String">
	<![CDATA[
	   delete from  SM_BIM_Sal_Pla_Reg where plan_code=#{plancode}
	]]>      
  </delete>	
		<resultMap id="cust" type="orderVO">
		<result property="custCode" column="General_Customer_Code" />
        <result property="custName" column="General_Customer_Name" />
        <result property="comNum" column="Company_Registration_Number" />
        <result property="repName" column="Representativs_Name" />	
	</resultMap> 
	
		<select id="orderCustList" resultMap="cust">
      <![CDATA[
         select * from SM_BIM_Gen_Cus_Reg 
      ]]>
	</select>
	<!-- order&cor (join)	 -->
	<resultMap id="orderList" type="orderVO">
		<result property="ordCode" column="ordersNum" />
        <result property="ordDate" column="ordersdate" />
        <result property="custCode" column="customerCode" />
        <result property="tax" column="tax" />
        <result property="note" column="note" />
        <collection property="corVO" javaType="CorVO">
        <id property="custCode" column="customerCode" />
        <result property="item_code" column="item_code" />
        <result property="item_name" column="item_name" />        
        <result property="stand" column="standard" />
        <result property="unit" column="inventory_unit" />
        <result property="dueDate" column="dueDate" />
        <result property="orderQuant" column="ordersQuantity" />
        <result property="price" column="productPrice" />
        <result property="expDate" column="expectedDate" />
        <result property="relDate" column="releaseExpectedDate" />
        <result property="inspection" column="inspection" />
        <result property="orderOX" column="orderOX" />
        </collection>
	</resultMap> 
	
		<select id="selectOrderList" resultMap="orderList">
      <![CDATA[
        select * from CSM_SM_Ord_Reg ORD, CSM_SM_COR_Reg COR
		 where ORD.customerCode = COR.customerCode
        ]]>
	</select>
	
	<select id="submitOrderCust" resultMap="orderList">
      <![CDATA[
        select * from CSM_SM_Ord_Reg ORD,CSM_SM_COR_Reg COR
		 where ORD.customerCode = COR.customerCode
		 and COR.customerCode = #{custCode}
        ]]>
	</select>
	
	  <select id="selOrdercode" resultMap="orderList" parameterType="int">
		<![CDATA[
		SELECT LAST_NUMBER FROM USER_SEQUENCES
		 WHERE SEQUENCE_NAME = upper('seq_CSM_SM_Ord_Reg_no')
		]]>
	</select> 
	<insert id="insertOrder" parameterType="orderVO">
		<![CDATA[
		 insert into CPM_BIM_BOM_REG
		 values(F_GET_NEXT_SEQ('CSM_SM_Ord_Reg'), #{ordDate}, #{custCode}, #{tax}, #{note})
		]]>  
	</insert>
				<!--popcust  F_GET_CURR_SEQ('SM_BIM_Gen_Cus_Reg')-->
	<resultMap id="custResult" type="estimateVO">
		<result property="custCode" column="General_Customer_Code" />
        <result property="custName" column="General_Customer_Name" />
        <result property="comNum" column="Company_Registration_Number" />
        <result property="repName" column="Representativs_Name" />	
	</resultMap> 
	
		<select id="selectCustList" resultMap="custResult">
      <![CDATA[
         select * from SM_BIM_Gen_Cus_Reg 
      ]]>
	</select>
	
	<delete id="delOrd"  parameterType="String">
	<![CDATA[
	   delete from  CPM_BIM_BOM_REG where ordersNum=#{ordCode}
	]]>      
  </delete>	
	
	
	<!-- estimate&cor (join) -->
	<resultMap id="estList" type="estimateVO">
		<id property="estCode" column="estimateNum" />
        <result property="estDate" column="estimateDate" />
        <result property="custCode" column="customerCode" />
        <result property="tax" column="tax" />
        <result property="note" column="note" />
        <collection property="corVO" javaType="CorVO">
        <id property="custCode" column="customerCode" />
        <result property="item_code" column="item_code" />
        <result property="item_name" column="item_name" />        
        <result property="stand" column="standard" />
        <result property="unit" column="inventory_unit" />
        <result property="dueDate" column="dueDate" />
        <result property="orderQuant" column="ordersQuantity" />
        <result property="price" column="productPrice" />
        </collection>
	</resultMap> 
	
		<select id="selectEstCorList" resultMap="estList">
      <![CDATA[
        select * from CSM_SM_Est_Reg EST,CSM_SM_COR_Reg COR
		 where EST.customerCode = COR.customerCode
        ]]>
	</select>
	
	<select id="submitEstSta" resultMap="estList">
      <![CDATA[
        select * from CSM_SM_Est_Reg EST,CSM_SM_COR_Reg COR
		 where EST.customerCode = COR.customerCode
		 and COR.customerCode = #{custCode}
        ]]>
	</select>
	
</mapper>